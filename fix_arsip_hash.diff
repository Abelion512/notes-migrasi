<<<<<<< SEARCH
    async saveNote(note: Omit<Note, 'updatedAt'>): Promise<Note> {
        if (Brankas.isLocked()) {
            throw new Error('Vault is locked. Cannot save data.');
        }

        const checkHash = await Integritas.hitungHash(note);
=======
    async saveNote(note: Omit<Note, 'updatedAt'>): Promise<Note> {
        if (Brankas.isLocked()) {
            throw new Error('Vault is locked. Cannot save data.');
        }

        // Ensure ID and timestamps are present before hashing for consistency
        const noteWithId = {
            ...note,
            id: note.id || uuidv4(),
            createdAt: note.createdAt || new Date().toISOString(),
        } as Note;

        const checkHash = await Integritas.hitungHash(noteWithId);
>>>>>>> REPLACE
<<<<<<< SEARCH
        const finalNote: Note = {
            ...note,
            title: secureTitle,
            content: secureContent,
            preview: securePreview,
            kredensial: secureKredensial,
            updatedAt: new Date().toISOString(),
            _hash: checkHash,
        };

        if (!finalNote.id) {
            finalNote.id = uuidv4();
            finalNote.createdAt = new Date().toISOString();
        }
=======
        const finalNote: Note = {
            ...noteWithId,
            title: secureTitle,
            content: secureContent,
            preview: securePreview,
            kredensial: secureKredensial,
            updatedAt: new Date().toISOString(),
            _hash: checkHash,
        };
>>>>>>> REPLACE
